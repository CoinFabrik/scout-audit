"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7259],{2721:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"detectors/substrate/unsigned-extrinsic","title":"Unsigned extrinsic","description":"Description","source":"@site/docs/detectors/substrate/unsigned-extrinsic.md","sourceDirName":"detectors/substrate","slug":"/detectors/substrate/unsigned-extrinsic","permalink":"/scout-audit/docs/detectors/substrate/unsigned-extrinsic","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/detectors/substrate/unsigned-extrinsic.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Unsafe unwrap","permalink":"/scout-audit/docs/detectors/substrate/unsafe-unwrap"},"next":{"title":"Rust","permalink":"/scout-audit/docs/category/rust"}}');var t=s(5105),r=s(6755);const c={},a="Unsigned extrinsic",o={},l=[{value:"Description",id:"description",level:2},{value:"Issue example",id:"issue-example",level:2},{value:"Remediation",id:"remediation",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"unsigned-extrinsic",children:"Unsigned extrinsic"})}),"\n",(0,t.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Category: ",(0,t.jsx)(n.code,{children:"DoS"})]}),"\n",(0,t.jsxs)(n.li,{children:["Severity: ",(0,t.jsx)(n.code,{children:"Critical"})]}),"\n",(0,t.jsxs)(n.li,{children:["Detectors: ",(0,t.jsx)(n.a,{href:"https://github.com/CoinFabrik/scout-audit/tree/main/detectors/substrate-pallets/unsigned-extrinsic",children:(0,t.jsx)(n.code,{children:"unsigned-extrinsic"})})]}),"\n",(0,t.jsxs)(n.li,{children:["Test Cases: ",(0,t.jsx)(n.a,{href:"https://github.com/CoinFabrik/scout-audit/tree/main/test-cases/substrate-pallets/unsigned-extrinsic",children:(0,t.jsx)(n.code,{children:"unsigned-extrinsic-1"})})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Unsigned extrinsics allow transactions to be submitted without any associated fees or signatures. This can be exploited by malicious actors to flood the network with transactions at no cost, potentially causing denial of service. Consider using signed extrinsics with appropriate fee mechanisms unless there's a specific security reason for allowing unsigned transactions."}),"\n",(0,t.jsx)(n.h2,{id:"issue-example",children:"Issue example"}),"\n",(0,t.jsx)(n.p,{children:"Consider the following function:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:"#[pallet::call(weight(<T as Config>::WeightInfo))]\nimpl<T: Config> Pallet<T> {\n    #[pallet::call_index(0)]\n    pub fn unsafe_call(origin: OriginFor<T>) -> DispatchResult {\n        ensure_none(origin)?;\n\n        Ok(())\n    }\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"unsafe_call"})," function uses ",(0,t.jsx)(n.code,{children:"ensure_none(origin)?"}),", which allows only unsigned transactions (i.e., where the origin is ",(0,t.jsx)(n.code,{children:"None"}),"). While this might seem harmless for internal runtime logic, it becomes problematic if this function is inadvertently exposed or misused."]}),"\n",(0,t.jsxs)(n.p,{children:["The vulnerable code example can be found ",(0,t.jsx)(n.a,{href:"https://github.com/CoinFabrik/scout-audit/tree/main/test-cases/substrate-pallets/unsigned-extrinsic/vulnerable/vulnerable-1",children:"here"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"remediation",children:"Remediation"}),"\n",(0,t.jsx)(n.p,{children:"To address this issue, restrict the function to signed extrinsics by requiring a valid signature from the caller. This ensures accountability and prevents unauthorized access. Here's the corrected implementation:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:"#[pallet::call(weight(<T as Config>::WeightInfo))]\nimpl<T: Config> Pallet<T> {\n    #[pallet::call_index(0)]\n    pub fn safe_call(origin: OriginFor<T>) -> DispatchResult {\n        let _ = ensure_signed(origin)?;\n\n        Ok(())\n    }\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The remediated code example can be found ",(0,t.jsx)(n.a,{href:"https://github.com/CoinFabrik/scout-audit/tree/main/test-cases/substrate-pallets/unsigned-extrinsic/remediated/remediated-1",children:"here"}),"."]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},6755:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>a});var i=s(8101);const t={},r=i.createContext(t);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);