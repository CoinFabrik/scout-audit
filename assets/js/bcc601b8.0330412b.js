"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6858],{5564:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"detectors/soroban/dos-unbounded-operation","title":"DoS unbounded operation","description":"Description","source":"@site/docs/detectors/soroban/11-dos-unbounded-operation.md","sourceDirName":"detectors/soroban","slug":"/detectors/soroban/dos-unbounded-operation","permalink":"/docs/detectors/soroban/dos-unbounded-operation","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/detectors/soroban/11-dos-unbounded-operation.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Avoid unsafe block","permalink":"/docs/detectors/soroban/avoid-unsafe-block"},"next":{"title":"Soroban version","permalink":"/docs/detectors/soroban/soroban-version"}}');var s=o(5105),i=o(6755);const a={},r="DoS unbounded operation",d={},c=[{value:"Description",id:"description",level:2},{value:"Why is this bad?",id:"why-is-this-bad",level:2},{value:"Issue example",id:"issue-example",level:2},{value:"Remediated example",id:"remediated-example",level:2},{value:"How is it detected?",id:"how-is-it-detected",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"dos-unbounded-operation",children:"DoS unbounded operation"})}),"\n",(0,s.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Category: ",(0,s.jsx)(n.code,{children:"Denial of Service"})]}),"\n",(0,s.jsxs)(n.li,{children:["Severity: ",(0,s.jsx)(n.code,{children:"Medium"})]}),"\n",(0,s.jsxs)(n.li,{children:["Detector: ",(0,s.jsx)(n.a,{href:"https://github.com/CoinFabrik/scout-soroban/tree/main/detectors/dos-unbounded-operation",children:(0,s.jsx)(n.code,{children:"dos-unbounded-operation"})})]}),"\n",(0,s.jsxs)(n.li,{children:["Test Cases: ",(0,s.jsx)(n.a,{href:"https://github.com/CoinFabrik/scout-soroban/tree/main/test-cases/dos-unbounded-operation/dos-unbounded-operation-1",children:(0,s.jsx)(n.code,{children:"dos-unbounded-operation-1"})})," ",(0,s.jsx)(n.a,{href:"https://github.com/CoinFabrik/scout-soroban/tree/main/test-cases/dos-unbounded-operation/dos-unbounded-operation-2",children:(0,s.jsx)(n.code,{children:"dos-unbounded-operation-2"})})," ",(0,s.jsx)(n.a,{href:"https://github.com/CoinFabrik/scout-soroban/tree/main/test-cases/dos-unbounded-operation/dos-unbounded-operation-3",children:(0,s.jsx)(n.code,{children:"dos-unbounded-operation-3"})})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Each block in a Stellar Blockchain has an upper bound on the amount of gas that can be spent, and thus the amount computation that can be done. This is the Block Gas Limit."}),"\n",(0,s.jsx)(n.h2,{id:"why-is-this-bad",children:"Why is this bad?"}),"\n",(0,s.jsx)(n.p,{children:"If the number of iterations is not limited to a specific range, it could potentially cause out of gas exceptions. If this happens, gas will leak, the transaction will fail, and there will be a risk of a potential attack on the contract."}),"\n",(0,s.jsx)(n.h2,{id:"issue-example",children:"Issue example"}),"\n",(0,s.jsx)(n.p,{children:"In the following example, a contract has a function \xb4unsafe_loop_with_array\xb4, which contains a for loop that iterates over a range of numbers from 0 to the lenght of the array \xb4unknown_array\xb4. The issue is that if the length of the array is extremely large, it would cause the loop to execute many times, potentially leading to an unusable state of the contract."}),"\n",(0,s.jsxs)(n.p,{children:["Consider the following ",(0,s.jsx)(n.code,{children:"Soroban"})," contract:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:" pub fn unsafe_loop_with_array(unknown_array: BytesN<8>) -> u32 {\n        let mut sum = 0;\n        for i in 0..unknown_array.len() {\n            sum += i;\n        }\n        sum\n    }\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The code example can be found ",(0,s.jsx)(n.a,{href:"https://github.com/CoinFabrik/scout-soroban/tree/main/test-cases/dos-unbounded-operation/dos-unbounded-operation-3/vulnerable-example",children:"here"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"remediated-example",children:"Remediated example"}),"\n",(0,s.jsx)(n.p,{children:"To solve this, instead of relying on an external parameter, we should introduce a known value directly into the loop."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:" pub fn safe_loop_with_array() -> u64 {\n        let mut sum = 0;\n        let known_array = [0; 8];\n        for i in 0..known_array.len() {\n            sum += i;\n        }\n        sum as u64\n    }\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The remediated code example can be found ",(0,s.jsx)(n.a,{href:"https://github.com/CoinFabrik/scout-soroban/tree/main/test-cases/dos-unbounded-operation/dos-unbounded-operation-3/remediated-example",children:"here"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"how-is-it-detected",children:"How is it detected?"}),"\n",(0,s.jsx)(n.p,{children:"This detector checks that when using for or while loops, their conditions limit the execution to a constant number of iterations."})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},6755:(e,n,o)=>{o.d(n,{R:()=>a,x:()=>r});var t=o(8101);const s={},i=t.createContext(s);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);